/*
Enter your query here.
*/
select x.hacker_id, h.name, sum(x.max_score) as total_score
from
(
select s.hacker_id, s.challenge_id, max(s.score) as max_score 
from submissions s
group by s.hacker_id, s.challenge_id
having max(s.score) > 0 
) x
join hackers h on 
x.hacker_id = h.hacker_id
group by x.hacker_id, h.name
order by total_score desc, x.hacker_id
